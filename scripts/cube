#!/bin/bash
# cube - Agent Cube CLI (wrapper for Python implementation)

set -e

# Check if cube-py is installed
if ! command -v cube-py &> /dev/null; then
    echo "âŒ Error: cube-py is not installed"
    echo ""
    echo "Install cube-py:"
    echo "  cd python && pip install -e ."
    echo ""
    echo "Or run the install script:"
    echo "  ./install.sh"
    exit 1
fi

# Set CUBE_TASK_ID from last-used task if not already set
CUBE_STATE_DIR="${HOME}/.cube"
CURRENT_TASK_FILE="${CUBE_STATE_DIR}/current-task"

if [ -z "$CUBE_TASK_ID" ] && [ -f "$CURRENT_TASK_FILE" ]; then
    export CUBE_TASK_ID=$(cat "$CURRENT_TASK_FILE" 2>/dev/null || echo "")
fi

# Delegate to Python implementation
exec cube-py "$@"
